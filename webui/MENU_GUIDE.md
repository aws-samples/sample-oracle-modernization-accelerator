# OMA Streamlit 메뉴 추가 가이드

## 🎯 표준 메뉴 패턴

모든 메뉴는 동일한 패턴을 따라 일관된 사용자 경험을 제공합니다.

### 📋 메뉴 구성 요소

1. **🏠 홈 버튼**: 상단 좌측, 명시적 홈 복귀
2. **📊 작업 상태**: 로그 파일 생성 확인
3. **📋 로그 보기**: 파일 생성 후 실시간 로그 연동
4. **🛑 작업 중단**: 실행 중인 작업 중단
5. **🔄 새로고침**: 상태 수동 업데이트

### 🚀 워크플로우

```
메뉴 클릭 → 백그라운드 실행 → 로그 파일 생성 → 로그 보기 → 실시간 모니터링
```

## 📝 새 메뉴 추가 방법

### 1단계: 템플릿 복사
```bash
cp menu_template.py new_menu.py
```

### 2단계: 템플릿 수정
- `MENU_NAME` → 실제 메뉴 이름
- 아이콘과 제목 수정
- 명령어와 로그 경로 수정
- 모든 key 값 고유하게 변경

### 3단계: 메인 앱에 통합
```python
# render_action_page()에 추가
elif action_key == "new_menu":
    render_new_menu_page()

# 사이드바 메뉴에 추가
MENU_STRUCTURE = {
    "🔍 애플리케이션 분석": {
        "새 메뉴": "new_menu",  # 추가
        # ...
    }
}
```

## 🔑 핵심 원칙

### ✅ DO (해야 할 것)
- 모든 key 값을 고유하게 설정
- 홈 버튼으로만 페이지 이동
- 로그 파일 생성 후 로그 보기 버튼 제공
- 백그라운드 실행으로 UI 블로킹 방지

### ❌ DON'T (하지 말 것)
- 자동 상태 초기화 로직 추가
- 복잡한 페이지 전환 로직
- 실시간 로그를 메인 페이지에 표시
- 동일한 key 값 사용

## 🎨 UI 일관성

### 버튼 스타일
- **🏠 홈으로**: `key="xxx_home"`
- **📋 로그 보기**: `key="view_logs_from_xxx"`
- **🛑 작업 중단**: `key="stop_xxx"`
- **🔄 새로고침**: `key="refresh_xxx"`

### 메시지 스타일
- **성공**: `st.success("✅ 로그 파일이 생성되었습니다")`
- **대기**: `st.info("⏳ 로그 파일 생성 대기 중...")`
- **경고**: `st.warning("🔄 작업이 이미 실행 중입니다")`
- **오류**: `st.error("❌ 다른 작업이 실행 중입니다")`

## 🧪 테스트 체크리스트

새 메뉴 추가 후 반드시 확인:

- [ ] 메뉴 클릭 시 정상 실행
- [ ] 로그 파일 생성 확인
- [ ] 로그 보기 버튼 정상 동작
- [ ] 실시간 로그 업데이트
- [ ] 홈 버튼으로 복귀
- [ ] 작업 중단 기능
- [ ] 다른 메뉴와 충돌 없음

## 📁 파일 구조

```
webui/
├── oma_streamlit_app.py      # 메인 애플리케이션
├── menu_template.py          # 메뉴 템플릿
├── MENU_GUIDE.md            # 이 가이드
└── oma_tasks/               # Task 파일 저장소
    ├── app_analysis_xxx.json
    └── new_menu_xxx.json
```

## 🔧 디버깅 팁

문제 발생 시 확인사항:

1. **key 중복**: 모든 버튼 key가 고유한지 확인
2. **로그 경로**: 환경 변수가 올바르게 설정되었는지 확인
3. **명령어**: 실제 실행 가능한 명령어인지 확인
4. **권한**: 로그 파일 쓰기 권한이 있는지 확인

---

**이 가이드를 따라하면 일관되고 안정적인 메뉴를 쉽게 추가할 수 있습니다!** 🚀
