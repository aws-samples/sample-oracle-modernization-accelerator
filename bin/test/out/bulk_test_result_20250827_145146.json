{
  "testInfo" : {
    "timestamp" : "2025-08-27 14:51:46",
    "directory" : "/home/ec2-user/workspace/tgt-postgres/src/main/resources/sqlmap/mapper/",
    "databaseType" : "POSTGRES",
    "totalTests" : 76,
    "successCount" : 75,
    "failureCount" : 1,
    "successRate" : "98.7"
  },
  "successfulTests" : [ {
    "xmlFile" : "PromotionMapper.xml",
    "sqlId" : "selectPromotionEffectivenessAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 4
  }, {
    "xmlFile" : "PromotionMapper.xml",
    "sqlId" : "selectCouponUsagePatternAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 4
  }, {
    "xmlFile" : "PromotionMapper.xml",
    "sqlId" : "selectPromotionABTestAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 4
  }, {
    "xmlFile" : "UserMapper.xml",
    "sqlId" : "selectUserList",
    "sqlType" : "SELECT",
    "rowCount" : 500
  }, {
    "xmlFile" : "UserMapper.xml",
    "sqlId" : "selectUserCount",
    "sqlType" : "SELECT",
    "rowCount" : 1
  }, {
    "xmlFile" : "UserMapper.xml",
    "sqlId" : "selectUserDetail",
    "sqlType" : "SELECT",
    "rowCount" : 0
  }, {
    "xmlFile" : "UserMapper.xml",
    "sqlId" : "selectUserActivityStats",
    "sqlType" : "SELECT",
    "rowCount" : 0
  }, {
    "xmlFile" : "UserMapper.xml",
    "sqlId" : "selectUserOrderHistory",
    "sqlType" : "SELECT",
    "rowCount" : 0
  }, {
    "xmlFile" : "UserMapper.xml",
    "sqlId" : "selectUserRegistrationTrend",
    "sqlType" : "SELECT",
    "rowCount" : 13
  }, {
    "xmlFile" : "UserMapper.xml",
    "sqlId" : "selectUserGradeStatistics",
    "sqlType" : "SELECT",
    "rowCount" : 3
  }, {
    "xmlFile" : "UserMapper.xml",
    "sqlId" : "selectUserHierarchyStats",
    "sqlType" : "SELECT",
    "rowCount" : 16
  }, {
    "xmlFile" : "UserMapper.xml",
    "sqlId" : "selectUserBehaviorPattern",
    "sqlType" : "SELECT",
    "rowCount" : 500
  }, {
    "xmlFile" : "UserMapper.xml",
    "sqlId" : "selectUserDemographicStats",
    "sqlType" : "SELECT",
    "rowCount" : 5
  }, {
    "xmlFile" : "UserMapper.xml",
    "sqlId" : "selectUserLifecycleAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 500
  }, {
    "xmlFile" : "UserMapper.xml",
    "sqlId" : "selectDormantUserAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 0
  }, {
    "xmlFile" : "UserMapper.xml",
    "sqlId" : "selectUserReferralHierarchy",
    "sqlType" : "SELECT",
    "rowCount" : 500
  }, {
    "xmlFile" : "AnalyticsMapper.xml",
    "sqlId" : "selectSalesDashboard",
    "sqlType" : "SELECT",
    "rowCount" : 233
  }, {
    "xmlFile" : "AnalyticsMapper.xml",
    "sqlId" : "selectCustomerBehaviorAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 442
  }, {
    "xmlFile" : "AnalyticsMapper.xml",
    "sqlId" : "selectRevenueTrend",
    "sqlType" : "SELECT",
    "rowCount" : 329
  }, {
    "xmlFile" : "AnalyticsMapper.xml",
    "sqlId" : "selectProductRevenueAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 784
  }, {
    "xmlFile" : "AnalyticsMapper.xml",
    "sqlId" : "selectCategoryRevenueAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 18
  }, {
    "xmlFile" : "AnalyticsMapper.xml",
    "sqlId" : "selectCustomerSegmentAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 3
  }, {
    "xmlFile" : "AnalyticsMapper.xml",
    "sqlId" : "selectRegionalRevenueAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 1
  }, {
    "xmlFile" : "AnalyticsMapper.xml",
    "sqlId" : "selectHourlyOrderPattern",
    "sqlType" : "SELECT",
    "rowCount" : 23
  }, {
    "xmlFile" : "AnalyticsMapper.xml",
    "sqlId" : "selectWeeklyOrderPattern",
    "sqlType" : "SELECT",
    "rowCount" : 7
  }, {
    "xmlFile" : "AnalyticsMapper.xml",
    "sqlId" : "selectMonthlyGrowthRate",
    "sqlType" : "SELECT",
    "rowCount" : 13
  }, {
    "xmlFile" : "AnalyticsMapper.xml",
    "sqlId" : "selectCohortAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 161
  }, {
    "xmlFile" : "AnalyticsMapper.xml",
    "sqlId" : "selectRFMAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 500
  }, {
    "xmlFile" : "OrderMapper.xml",
    "sqlId" : "selectOrderListWithAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 1000
  }, {
    "xmlFile" : "OrderMapper.xml",
    "sqlId" : "selectOrderProcessingTimeAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 2
  }, {
    "xmlFile" : "OrderMapper.xml",
    "sqlId" : "selectCustomerOrderPatternAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 401
  }, {
    "xmlFile" : "OrderMapper.xml",
    "sqlId" : "selectOrderStatusStatistics",
    "sqlType" : "SELECT",
    "rowCount" : 6
  }, {
    "xmlFile" : "OrderMapper.xml",
    "sqlId" : "selectOrderTrendAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 344
  }, {
    "xmlFile" : "OrderMapper.xml",
    "sqlId" : "selectPaymentMethodStatistics",
    "sqlType" : "SELECT",
    "rowCount" : 1
  }, {
    "xmlFile" : "OrderMapper.xml",
    "sqlId" : "selectOrderCount",
    "sqlType" : "SELECT",
    "rowCount" : 1
  }, {
    "xmlFile" : "OrderMapper.xml",
    "sqlId" : "selectOrderDetail",
    "sqlType" : "SELECT",
    "rowCount" : 0
  }, {
    "xmlFile" : "OrderMapper.xml",
    "sqlId" : "selectOrderItems",
    "sqlType" : "SELECT",
    "rowCount" : 0
  }, {
    "xmlFile" : "OrderMapper.xml",
    "sqlId" : "selectOrderShippingInfo",
    "sqlType" : "SELECT",
    "rowCount" : 0
  }, {
    "xmlFile" : "ShippingMapper.xml",
    "sqlId" : "selectShippingPerformanceAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 0
  }, {
    "xmlFile" : "ShippingMapper.xml",
    "sqlId" : "selectShippingDelayPatternAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 0
  }, {
    "xmlFile" : "ShippingMapper.xml",
    "sqlId" : "selectShippingRouteOptimizationAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 0
  }, {
    "xmlFile" : "PaymentMapper.xml",
    "sqlId" : "selectPaymentAnalyticsDashboard",
    "sqlType" : "SELECT",
    "rowCount" : 8
  }, {
    "xmlFile" : "PaymentMapper.xml",
    "sqlId" : "selectPaymentFailurePatternAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 1
  }, {
    "xmlFile" : "PaymentMapper.xml",
    "sqlId" : "selectPaymentMethodPerformanceAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 1
  }, {
    "xmlFile" : "PaymentMapper.xml",
    "sqlId" : "selectPaymentList",
    "sqlType" : "SELECT",
    "rowCount" : 1000
  }, {
    "xmlFile" : "PaymentMapper.xml",
    "sqlId" : "selectPaymentCount",
    "sqlType" : "SELECT",
    "rowCount" : 1
  }, {
    "xmlFile" : "PaymentMapper.xml",
    "sqlId" : "selectPaymentDetail",
    "sqlType" : "SELECT",
    "rowCount" : 0
  }, {
    "xmlFile" : "PaymentMapper.xml",
    "sqlId" : "selectPaymentMethodStatistics",
    "sqlType" : "SELECT",
    "rowCount" : 1
  }, {
    "xmlFile" : "PaymentMapper.xml",
    "sqlId" : "selectPaymentStatusStatistics",
    "sqlType" : "SELECT",
    "rowCount" : 3
  }, {
    "xmlFile" : "PaymentMapper.xml",
    "sqlId" : "selectDailyPaymentTrend",
    "sqlType" : "SELECT",
    "rowCount" : 344
  }, {
    "xmlFile" : "PaymentMapper.xml",
    "sqlId" : "selectPaymentFailureAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 1
  }, {
    "xmlFile" : "PaymentMapper.xml",
    "sqlId" : "selectRefundStatistics",
    "sqlType" : "SELECT",
    "rowCount" : 0
  }, {
    "xmlFile" : "PaymentMapper.xml",
    "sqlId" : "selectPaymentProcessingTimeAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 1
  }, {
    "xmlFile" : "ProductAdvancedMapper.xml",
    "sqlId" : "selectPriceHistoryAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 760
  }, {
    "xmlFile" : "ProductAdvancedMapper.xml",
    "sqlId" : "selectProductLifecycleAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 760
  }, {
    "xmlFile" : "ProductAdvancedMapper.xml",
    "sqlId" : "selectInventoryForecastAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 1300
  }, {
    "xmlFile" : "ProductMapper.xml",
    "sqlId" : "selectCategoryHierarchy",
    "sqlType" : "SELECT",
    "rowCount" : 23
  }, {
    "xmlFile" : "ProductMapper.xml",
    "sqlId" : "selectProductList",
    "sqlType" : "SELECT",
    "rowCount" : 800
  }, {
    "xmlFile" : "ProductMapper.xml",
    "sqlId" : "selectProductCount",
    "sqlType" : "SELECT",
    "rowCount" : 1
  }, {
    "xmlFile" : "ProductMapper.xml",
    "sqlId" : "selectProductDetail",
    "sqlType" : "SELECT",
    "rowCount" : 0
  }, {
    "xmlFile" : "ProductMapper.xml",
    "sqlId" : "selectProductPerformanceAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 800
  }, {
    "xmlFile" : "ProductMapper.xml",
    "sqlId" : "selectBrandStatistics",
    "sqlType" : "SELECT",
    "rowCount" : 31
  }, {
    "xmlFile" : "ProductMapper.xml",
    "sqlId" : "selectCategoryStatistics",
    "sqlType" : "SELECT",
    "rowCount" : 23
  }, {
    "xmlFile" : "ProductMapper.xml",
    "sqlId" : "selectProductInventoryStatus",
    "sqlType" : "SELECT",
    "rowCount" : 1365
  }, {
    "xmlFile" : "ProductMapper.xml",
    "sqlId" : "selectProductPriceHistory",
    "sqlType" : "SELECT",
    "rowCount" : 0
  }, {
    "xmlFile" : "SellerMapper.xml",
    "sqlId" : "selectSellerPerformanceAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 100
  }, {
    "xmlFile" : "SellerMapper.xml",
    "sqlId" : "selectSellerProductPortfolioAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 100
  }, {
    "xmlFile" : "CustomerServiceMapper.xml",
    "sqlId" : "selectCustomerServicePerformanceAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 15
  }, {
    "xmlFile" : "CustomerServiceMapper.xml",
    "sqlId" : "selectCustomerInquiryPatternAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 5
  }, {
    "xmlFile" : "CustomerServiceMapper.xml",
    "sqlId" : "selectCustomerSatisfactionAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 1
  }, {
    "xmlFile" : "CustomerServiceMapper.xml",
    "sqlId" : "selectCustomerSupportEscalationChain",
    "sqlType" : "SELECT",
    "rowCount" : 85
  }, {
    "xmlFile" : "InventoryMapper.xml",
    "sqlId" : "selectInventoryStatusAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 1365
  }, {
    "xmlFile" : "InventoryMapper.xml",
    "sqlId" : "selectWarehouseInventoryAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 100
  }, {
    "xmlFile" : "InventoryMapper.xml",
    "sqlId" : "selectInventoryMovementTracking",
    "sqlType" : "SELECT",
    "rowCount" : 1075
  }, {
    "xmlFile" : "InventoryMapper.xml",
    "sqlId" : "selectInventoryOptimizationAnalysis",
    "sqlType" : "SELECT",
    "rowCount" : 817
  } ],
  "failedTests" : [ {
    "xmlFile" : "ProductMapper.xml",
    "sqlId" : "selectProductRecommendations",
    "sqlType" : "SELECT",
    "errorMessage" : "\n### Error querying database.  Cause: org.postgresql.util.PSQLException: ERROR: recursive reference to query \"category_hierarchy\" must not appear within its non-recursive term\n  Position: 559\n### The error may exist in file:///tmp/mapper-7351185143472076583.xml\n### The error may involve amzn.bo.mapper.ProductMapper.selectProductRecommendations-Inline\n### The error occurred while setting parameters\n### SQL: WITH RECURSIVE category_hierarchy AS (             -- Base case: Get base product category             SELECT CATEGORY_ID, PARENT_CATEGORY_ID, 1 as level, 'SAME' as relation_type             FROM CATEGORIES              WHERE CATEGORY_ID = (SELECT CATEGORY_ID FROM PRODUCTS WHERE PRODUCT_ID = ?::bigint)                          UNION ALL                          -- Recursive case: Get parent categories (upward)             SELECT c.CATEGORY_ID, c.PARENT_CATEGORY_ID, ch.level + 1, 'PARENT' as relation_type             FROM CATEGORIES c             JOIN category_hierarchy ch ON c.CATEGORY_ID = ch.PARENT_CATEGORY_ID             WHERE ch.relation_type IN ('SAME', 'PARENT')                          UNION ALL                          -- Recursive case: Get child categories (downward)               SELECT c.CATEGORY_ID, c.PARENT_CATEGORY_ID, ch.level + 1, 'CHILD' as relation_type             FROM CATEGORIES c             JOIN category_hierarchy ch ON c.PARENT_CATEGORY_ID = ch.CATEGORY_ID             WHERE ch.relation_type IN ('SAME', 'CHILD')         )         SELECT              p.PRODUCT_ID,             p.PRODUCT_NAME,             p.SKU,             p.BASE_PRICE,             c.CATEGORY_NAME,             rec_stats.RECOMMENDATION_SCORE,             rec_stats.FREQUENTLY_BOUGHT_TOGETHER_COUNT,             rec_stats.SIMILAR_CUSTOMERS_COUNT,             rec_stats.CATEGORY_AFFINITY_SCORE,             RANK() OVER (ORDER BY rec_stats.RECOMMENDATION_SCORE DESC) as RECOMMENDATION_RANK         FROM PRODUCTS p         JOIN CATEGORIES c ON p.CATEGORY_ID = c.CATEGORY_ID         JOIN (SELECT                  target_product.PRODUCT_ID,                 -- 함께 구매된 횟수 기반 점수                 COALESCE(bought_together.TOGETHER_COUNT, 0) * 0.4 +                 -- 유사 고객 구매 패턴 기반 점수                   COALESCE(similar_customers.SIMILAR_PURCHASE_SCORE, 0) * 0.3 +                 -- 카테고리 친화도 점수                 COALESCE(category_affinity.AFFINITY_SCORE, 0) * 0.3 as RECOMMENDATION_SCORE,                 COALESCE(bought_together.TOGETHER_COUNT, 0) as FREQUENTLY_BOUGHT_TOGETHER_COUNT,                 COALESCE(similar_customers.SIMILAR_CUSTOMERS_COUNT, 0) as SIMILAR_CUSTOMERS_COUNT,                 COALESCE(category_affinity.AFFINITY_SCORE, 0) as CATEGORY_AFFINITY_SCORE               FROM PRODUCTS target_product               LEFT JOIN (-- 함께 구매된 상품 분석                       SELECT                          oi2.PRODUCT_ID,                         COUNT(*) as TOGETHER_COUNT                       FROM ORDER_ITEMS oi1                       JOIN ORDER_ITEMS oi2 ON oi1.ORDER_ID = oi2.ORDER_ID                       WHERE oi1.PRODUCT_ID = ?::bigint                       AND oi2.PRODUCT_ID != ?::bigint                       GROUP BY oi2.PRODUCT_ID) AS bought_together ON target_product.PRODUCT_ID = bought_together.PRODUCT_ID               LEFT JOIN (-- 유사 고객 구매 패턴 분석                       SELECT                          oi_other.PRODUCT_ID,                         COUNT(DISTINCT oi_other.ORDER_ID) as SIMILAR_PURCHASE_SCORE,                         COUNT(DISTINCT o_other.USER_ID) as SIMILAR_CUSTOMERS_COUNT                       FROM ORDER_ITEMS oi_base                       JOIN ORDERS o_base ON oi_base.ORDER_ID = o_base.ORDER_ID                       JOIN ORDERS o_other ON o_base.USER_ID = o_other.USER_ID                       JOIN ORDER_ITEMS oi_other ON o_other.ORDER_ID = oi_other.ORDER_ID                       WHERE oi_base.PRODUCT_ID = ?::bigint                       AND oi_other.PRODUCT_ID != ?::bigint                       AND o_base.ORDER_STATUS NOT IN ('CANCELLED', 'REFUNDED')                       AND o_other.ORDER_STATUS NOT IN ('CANCELLED', 'REFUNDED')                       GROUP BY oi_other.PRODUCT_ID) AS similar_customers ON target_product.PRODUCT_ID = similar_customers.PRODUCT_ID               LEFT JOIN (-- 카테고리 친화도 분석                       SELECT                          p_cat.PRODUCT_ID,                         CASE                            WHEN p_cat.CATEGORY_ID = base_cat.CATEGORY_ID THEN 100                           WHEN p_cat.CATEGORY_ID IN (                             SELECT CATEGORY_ID FROM category_hierarchy WHERE relation_type IN ('PARENT', 'CHILD')                           ) THEN 70                           ELSE 20                         END as AFFINITY_SCORE                       FROM PRODUCTS p_cat                       CROSS JOIN (SELECT CATEGORY_ID FROM PRODUCTS WHERE PRODUCT_ID = ?::bigint) AS base_cat) AS category_affinity ON target_product.PRODUCT_ID = category_affinity.PRODUCT_ID               WHERE target_product.PRODUCT_ID != ?::bigint               AND target_product.STATUS = 'ACTIVE') AS rec_stats ON p.PRODUCT_ID = rec_stats.PRODUCT_ID         WHERE 1=1           AND rec_stats.RECOMMENDATION_SCORE > ?::numeric           ORDER BY RECOMMENDATION_RANK\n### Cause: org.postgresql.util.PSQLException: ERROR: recursive reference to query \"category_hierarchy\" must not appear within its non-recursive term\n  Position: 559"
  } ],
  "fileStatistics" : [ {
    "fileName" : "ShippingMapper.xml",
    "totalTests" : 3,
    "successCount" : 3,
    "failureCount" : 0,
    "successRate" : "100.0"
  }, {
    "fileName" : "PromotionMapper.xml",
    "totalTests" : 3,
    "successCount" : 3,
    "failureCount" : 0,
    "successRate" : "100.0"
  }, {
    "fileName" : "UserMapper.xml",
    "totalTests" : 13,
    "successCount" : 13,
    "failureCount" : 0,
    "successRate" : "100.0"
  }, {
    "fileName" : "SellerMapper.xml",
    "totalTests" : 2,
    "successCount" : 2,
    "failureCount" : 0,
    "successRate" : "100.0"
  }, {
    "fileName" : "AnalyticsMapper.xml",
    "totalTests" : 12,
    "successCount" : 12,
    "failureCount" : 0,
    "successRate" : "100.0"
  }, {
    "fileName" : "InventoryMapper.xml",
    "totalTests" : 4,
    "successCount" : 4,
    "failureCount" : 0,
    "successRate" : "100.0"
  }, {
    "fileName" : "ProductMapper.xml",
    "totalTests" : 10,
    "successCount" : 9,
    "failureCount" : 1,
    "successRate" : "90.0"
  }, {
    "fileName" : "ProductAdvancedMapper.xml",
    "totalTests" : 3,
    "successCount" : 3,
    "failureCount" : 0,
    "successRate" : "100.0"
  }, {
    "fileName" : "OrderMapper.xml",
    "totalTests" : 10,
    "successCount" : 10,
    "failureCount" : 0,
    "successRate" : "100.0"
  }, {
    "fileName" : "CustomerServiceMapper.xml",
    "totalTests" : 4,
    "successCount" : 4,
    "failureCount" : 0,
    "successRate" : "100.0"
  }, {
    "fileName" : "PaymentMapper.xml",
    "totalTests" : 12,
    "successCount" : 12,
    "failureCount" : 0,
    "successRate" : "100.0"
  } ]
}